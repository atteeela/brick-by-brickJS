/*
Copyright (c) 2014 S. William & A.M. Pritchard
Licensed Under MIT
*/
!function(n){function e(n,e){return onresize=function(){clearTimeout(e),e=setTimeout(n,100)},n}function i(){var e=n(".b-by-b-item").width(),i=100/(parseInt(e)/c.width()*100),t=Math.round(i);return t}function t(){l=c.children(".b-by-b-item"),l.remove(),n(s).appendTo(c),l.removeAttr("data-column"),n(".single-column").remove()}function r(n){n.css({padding:f.itemPadding,"margin-top":f.itemMargin,"margin-bottom":f.itemMargin,"box-sizing":"border-box"})}function a(e){for(var i=0;e>i;i++)c.prepend('<div class="single-column 1of'+e+'"></div>');c.children(".single-column").css({"float":"left",width:100/e+"%","padding-left":f.itemMargin/2,"padding-right":f.itemMargin/2,"box-sizing":"border-box"}),l=c.children(".b-by-b-item"),r(l);for(var i=0;e>i;i++)l.filter(function(n){return n%e===i}).attr("data-column",i);n.each(l,function(i,t){var r=("#"+n(t).attr("id"),n(t).attr("data-column")),a=".1of"+e+":eq("+r+")";n(this).appendTo(a)}),n(".b-by-b-item").fadeIn(500)}function o(){var e;e=c.prop("id").length>0?"#"+c.prop("id"):"."+c.prop("class"),n("head").append("<style>"+e+':after { content:""; display:table; clear:both; }</style>')}var s,d,c,l,u=null,f=null,p={init:function(r){var p,h;return f=n.extend({itemMargin:5,itemPadding:5},r),n(this).children("div, section, article, img, a").addClass("b-by-b-item"),c=n(this),l=c.children(".b-by-b-item"),c.css("width","100%"),s=l.clone(),u=s,d=l.clone(),e(function(){c.hasClass("no-grid")||(t(),h=i(),a(h))}),n(window).resize(),t(),p=i(),a(p),o(),this},addAfter:function(e){for(var o,l=0;l<e.length;l++){var f=n(e[l]).addClass("b-by-b-item");[].push.apply(u,n.makeArray(f)),[].push.apply(d,n.makeArray(f))}s=n.grep(u,function(n){return"undefined"!=typeof n}),t(),c.hasClass("no-grid")?r(c.children(".b-by-b-item")):(o=i(),a(o))},addBefore:function(e){for(var o,l=0;l<e.length;l++){var f=n(e[l]).addClass("b-by-b-item");[].unshift.apply(d,n.makeArray(f)),[].unshift.apply(u,n.makeArray(f))}s=n.grep(u,function(n){return"undefined"!=typeof n}),t(),c.hasClass("no-grid")?r(c.children(".b-by-b-item")):(o=i(),a(o))},removeItems:function(e,r){var o;n.each(e,function(e,i){for(var t=0;t<d.length;t++)n(d[t]).is(i)&&(n(i).animate({opacity:0},r),d.splice(t,1),u.splice(t,1),t--)}),s=n.grep(u,function(n){return"undefined"!=typeof n}),setTimeout(function(){t(),c.hasClass("no-grid")||(o=i(),a(o))},r+1)},hideItems:function(e,r){var o;n.each(e,function(e,i){for(var t=0;t<u.length;t++)n(i).animate({opacity:0},r),n(u[t]).is(i)&&(delete u[t],t--)}),s=n.grep(u,function(n){return"undefined"!=typeof n}),setTimeout(function(){t(),c.hasClass("no-grid")||(o=i(),a(o))},r+1)},showItems:function(e,o){var l,f=d;n.each(e,function(e,i){for(var t=0;t<f.length;t++)n(f[t]).is(i)&&(u[t]=f[t])}),s=n.grep(u,function(n){return"undefined"!=typeof n}),t(),n.each(e,function(e,i){n(i).css("opacity",0)}),c.hasClass("no-grid")||(l=i(),a(l)),n.each(e,function(e,i){n(i).animate({opacity:1},o),r(n(i))})},reload:function(){var n;c.hasClass("no-grid")&&(c.removeClass("no-grid"),t(),n=i(),a(n))},end:function(){c.hasClass("no-grid")||(t(),c.addClass("no-grid"))}};n.fn.layout=function(e){return p[e]?p[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(n.error("Method "+e+" does not exist in Brick by Brick JS"),void 0):p.init.apply(this,arguments)}}(jQuery);
